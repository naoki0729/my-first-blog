**本プロジェクトで解決したい課題**

現在、ホールスタッフの人数を各店舗の店長が経験から決定しているため、時間帯によって人数の過不足が発生している可能性がある。
そこで、ホールスタッフの配置を最適化することを目的とした機械学習モデルを構築、運用していく。
今回は1日の1時間あたりの客数を予測して、ホールスタッフの人数最適化を行っていく。
これにより、人的コストの削減だけでなく、客数に対する最適な接客人数の推定も可能となるため、ホールスタッフの働きやすさにも繋がる。


**課題が解決できている状態の定義**

まず、以下の項目を設定する。（表内の数字は大規模店で考える例である）
| 日時             | 店内にいるスタッフの人数 | 入店者数 | 接客に必要な人数 | 稼働率（接客に必要な人数÷店内にいるスタッフの人数、100%以上の場合は丸める） | カバー率（店内にいるスタッフの人数÷接客に必要な人数、100%以上の場合は丸める) | 
| ---------------- | ------------------------ | -------- | ---------------- | --------------------------------------------------- | ---------------------------------------------------- | 
| 2022/11/25 10:00 | 2                        | 5        | 1                | 50%                                                 | 100%                                                 | 
| 2022/11/25 11:00 | 2                        | 10       | 2                | 100%                                                | 100%                                                 | 
| 2022/11/25 12:00 | 3                        | 30       | 6                | 100%                                                | 50%                                                  | 

上記の表にある、稼働率とカバー率の両方を高め、その結果起こる人的コストの削減による店舗の利益が増加すれば今回の課題が解決できている状態だと定義する。
各店舗は関東地方および東北地方の地域別に存在することに加えて、大規模店と中規模店の種類に分けられるため、それぞれの条件内で施策を適用する店舗と適用しない店舗を設定し、結果から各条件内で比較を行い効果検証を行っていく。

**システム構成**
![image](https://user-images.githubusercontent.com/113179618/204151652-00973f9f-95b9-4b04-90c4-bc0ed3a03ce7.png)

①：店舗内で毎日客数データを集計してもらい、データベースへ収集・格納する。
②：集まったデータに対して前処理を行い、必要な特徴量エンジニアリング等を行う。
③・④：予測モデルを作成して、客数予測値を算出する。
⑤：予測結果を随時データベースへ格納していく。
⑥：客数実測値が揃ったタイミングで、月毎の客数予測値との比較検証を行う。
⑦：結果的に精度改善をする必要があれば改善を行えるように監視する。

メンバー構成は、プロジェクトマネージャー、プロジェクトリーダー、データサイエンティスト複数名で行う。
プロジェクトマネージャーは、プロジェクト費用やスケジュールを管理、また課題に対する運用の見通しを立てる。
プロジェクトリーダーは、各データサイエンティストに仕事を割り振り、チームの意見をまとめて店長に説明や提案をする。
データサイエンティストは、客数データを集計してもらった後、上記の図にある処理を行う。
また、導入前後の稼働率とカバー率、各店舗の利益の推移結果も管理する。


**機械学習のプログラム、モデル、推論結果の管理方法**

機械学習のプログラムは、チーム内で定期スケジュール設定をして、随時レビューを行う。
共有時はjupyter notebookではなく、pythonスクリプトを使用し、gitを用いて管理する。
過去に作成したモデルは、pklファイルで保存し、特徴量やモデル手法といった設定はyamlファイルで保存する。
ここで管理方法を共通化しておくことで、過去のモデルを再利用したり、比較評価することが可能になる。
推論結果に関しては、必ず可視化を行った上で、プロジェクトメンバー向けと店舗の店長向けの報告資料を作り分けておく。
客数予測における精度誤差が±30%以上のモデルは破棄していき、推論結果と共に3年間は保存しておく。


**機械学習の学習と推論を実行するタイミング**

システム構成にある①にて集まったデータに関しては、csvやpkl等の形態で保存し、管理しておく。（Ⅰ）
システム構成にある②〜⑤は、1ヶ月が経った段階で随時実行し、前月のデータから前処理や学習、推論を行っていく。（Ⅱ）
推論結果から各店舗の店長に最適な人数を提案し、シフトを作成してもらう。（Ⅲ）
1ヶ月経過後に実測値が出てくるので、システム構成にある⑥、⑦を実行して、随時モデルを修正する。
モデルについては、精度誤差が±30%以上の日数が存在した場合、あるいは±10%以上の日数が10日以上存在した場合に修正する。（Ⅳ）

2023年1月の最適人数を設定したい場合のスケジュール例(初めてモデル構築する場合)：
11月末まで11月中のデータ収集（Ⅰ）→12月1日〜10日に（Ⅱ）を実行→12月11日〜20日に（Ⅲ）を実行し、1月分のシフトを作成→12月末まで12月中のデータ収集（Ⅰ）

2023年2月の最適人数を設定したい場合のスケジュール例(施策開始後の場合)：
12月末まで12月中のデータ収集（Ⅰ）→1月1日〜10日に（Ⅱ）と（Ⅳ）を実行→1月11日〜20日に（Ⅲ）を実行し、2月分のシフトを作成→2月末まで2月中のデータ収集（Ⅰ）


**店舗への連絡方法**
上記のスケジュールにある通り、予測を行った月の前月の11日から20日にプロジェクトリーダーから各店舗の店長へ連絡する。
連絡手段は、基本的にテキストベースでメール等で配信する。
このタイミングで連絡することで、当月のシフト調整までに1週間以上の猶予期間を設けることができる。
さらにもし障害や異常事態の発生しても、基本的にデータサイエンティストの仕事を上旬にまとめているので対応が可能である。
施策を行った月の下旬には、施策を改善するために店舗ヒアリングを行い、現場の声を拾うようにする。


**ホールスタッフの人員配置が適切に実施されていることを確認する方法**
店舗から情報収集する方法としては、毎月の下旬に店長へヒアリングを行う。
また、2ヶ月に1度店長以外のスタッフにもヒアリングを行い、より現場に近い声を拾う。
適切に実施されていない場合には、ヒアリングの際に理由や原因について尋ねる。
改善を促すためには、実際に施策を行った他店舗の稼働率とカバー率、店舗の利益推移を可視化した上で再度説明する。
施策を実施していると思われる店舗に対しては、半年経過後にヒアリングの頻度をそれぞれ3ヶ月毎に減らし、予測結果を配信するメールにアンケートを追加する。
アンケートにて集まったデータと客数予測値との比較検証内容により施策を評価する要素とする。


**本プロジェクトの成否を判断するための数値的な評価基準**
半年経過時点で、施策を実施した店舗と実施していない店舗での比較を行い、施策自体の効果を検証する。
また、実施した店舗内では月毎のモデル構築と改善で精度が改善されていくことが見込まれるため、稼働率とカバー率の両方が初月の結果より半年間で各25%増加、店舗の利益が25%増加した場合に成功と判断する。
加えて、アンケート内にて満足度評価を5段階別に設定しておき、半年経過後の平均値が4.0を上回ることを目標とする。


**本プロジェクトの品質を維持し、改善する方法**
施策を維持していくためにも、


施策を維持する方法。1点
評価を改善施策（またはプロジェクトを終了する指標）にする方法。2点
運用を自動化する方法。2点




